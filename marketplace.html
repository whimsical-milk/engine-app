<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Marketplace</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1>Marketplace</h1>

  <div id="userInfo" class="box">Checking login...</div>

  <!-- Login / Signup Buttons -->
  <div id="authButtons" class="box" style="display:none">
    <button onclick="location.href='index.html'">Login / Signup</button>
  </div>

  <hr>

  <div id="games" class="box">
    <p>Game list will appear here.</p>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

/* ðŸ”¥ Firebase config */
const firebaseConfig = {
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT_ID",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const userInfo = document.getElementById('userInfo');
const authButtons = document.getElementById('authButtons');

onAuthStateChanged(auth, async (user) => {
  if (user) {
    // Logged in â€” show username
    try {
      const snap = await getDoc(doc(db, "users", user.uid));
      const data = snap.data();
      userInfo.innerText = `Logged in as ${data.username}`;
      authButtons.style.display = "none";
    } catch (err) {
      console.error(err);
      userInfo.innerText = "Error loading user info";
      authButtons.style.display = "block";
    }
  } else {
    // Not logged in â€” show login/signup button
    userInfo.innerText = "You are not logged in";
    authButtons.style.display = "block";
  }
});
</script>

</body>
</html>
